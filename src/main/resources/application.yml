spring:
  application:
    name: spring_techincal_review_z
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:prod}  # Default to prod, override with env var
  r2dbc:
    url: ${R2DBC_URL:r2dbc:h2:mem:///testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
    username: ${R2DBC_USERNAME:sa}
    password: ${R2DBC_PASSWORD:}
    pool:
      initial-size: ${R2DBC_POOL_INITIAL_SIZE:5}
      max-size: ${R2DBC_POOL_MAX_SIZE:10}
      max-idle-time: ${R2DBC_POOL_MAX_IDLE_TIME:30m}

server:
  port: ${SERVER_PORT:8080}
  error:
    include-message: never
    include-binding-errors: never
    include-stacktrace: never
    include-exception: false

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized

logging:
  level:
    root: WARN
    com.felipe.spring_techincal_review_z: INFO
    org.springframework.web: WARN
  file:
    name: logs/application.log
    max-size: 10MB
    max-history: 30
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

---
# DEV Profile - Opt-in for development
spring:
  config:
    activate:
      on-profile: dev
  h2:
    console:
      enabled: true

server:
  error:
    include-message: always
    include-binding-errors: always
    include-stacktrace: on-param
    include-exception: true

logging:
  level:
    com.felipe.spring_techincal_review_z: DEBUG
    org.springframework.r2dbc: DEBUG
    io.r2dbc.h2: DEBUG
    org.springframework.web: DEBUG

---
# TEST Profile
spring:
  config:
    activate:
      on-profile: test
  h2:
    console:
      enabled: false

logging:
  level:
    root: WARN
    com.felipe.spring_techincal_review_z: INFO
    org.springframework.web: WARN

---
# PROD Profile
spring:
  config:
    activate:
      on-profile: prod
  h2:
    console:
      enabled: false

server:
  error:
    include-message: never
    include-binding-errors: never
    include-stacktrace: never
    include-exception: false

logging:
  level:
    root: WARN
    com.felipe.spring_techincal_review_z: INFO
    org.springframework.web: WARN